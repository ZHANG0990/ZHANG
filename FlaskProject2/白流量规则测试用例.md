# 白流量规则管理系统测试用例

## 📋 测试环境说明

- **系统版本**: Flask流量分析系统
- **测试时间**: 2025年8月15日
- **测试目的**: 验证白流量规则管理功能的正确性
- **测试方法**: 手动输入或CSV文件上传

---

## 🧪 测试用例分类

### 1. 恶意流量测试用例 ❌

#### 1.1 SQL注入攻击
```
源IP: 192.168.1.100
目标IP: 203.0.113.50
流量类型: HTTP
请求内容: SELECT * FROM users WHERE id=1
预期结果: 恶意流量
```

#### 1.2 XSS攻击
```
源IP: 10.0.0.5
目标IP: 8.8.8.8
流量类型: HTTP
请求内容: <script>alert("xss")</script>
预期结果: 恶意流量
```

#### 1.3 后门访问
```
源IP: 192.168.0.100
目标IP: 192.168.1.1
流量类型: HTTP
请求内容: /admin/login.php
预期结果: 恶意流量
```

#### 1.4 系统命令执行
```
源IP: 172.16.0.10
目标IP: 172.16.0.1
流量类型: TCP
请求内容: cmd.exe /c dir
预期结果: 恶意流量
```

#### 1.5 WordPress攻击
```
源IP: 203.0.113.100
目标IP: 192.168.1.50
流量类型: HTTP
请求内容: /wp-admin/admin-ajax.php
预期结果: 恶意流量
```

#### 1.6 系统文件访问
```
源IP: 10.10.10.10
目标IP: 10.10.10.1
流量类型: HTTP
请求内容: /etc/passwd
预期结果: 恶意流量
```

#### 1.7 PowerShell攻击
```
源IP: 192.168.2.100
目标IP: 192.168.2.1
流量类型: TCP
请求内容: powershell.exe -enc
预期结果: 恶意流量
```

#### 1.8 恶意PHP后门
```
源IP: 172.20.0.50
目标IP: 172.20.0.1
流量类型: HTTP
请求内容: /malicious/backdoor.php
预期结果: 恶意流量
```

---

### 2. 可疑流量测试用例 ⚠️

#### 2.1 用户删除操作
```
源IP: 192.168.1.50
目标IP: 192.168.1.1
流量类型: HTTP
请求内容: /api/user/delete
预期结果: 可疑流量
```

#### 2.2 系统配置访问
```
源IP: 127.0.0.1
目标IP: 127.0.0.1
流量类型: HTTP
请求内容: /system/config
预期结果: 可疑流量
```

#### 2.3 危险系统命令
```
源IP: 10.0.0.100
目标IP: 10.0.0.1
流量类型: SSH
请求内容: rm -rf /
预期结果: 可疑流量
```

#### 2.4 数据库删除操作
```
源IP: 172.16.1.100
目标IP: 172.16.1.10
流量类型: TCP
请求内容: DROP TABLE users
预期结果: 可疑流量
```

#### 2.5 调试信息访问
```
源IP: 192.168.3.50
目标IP: 192.168.3.1
流量类型: HTTP
请求内容: /debug/info
预期结果: 可疑流量
```

---

### 3. 正常流量测试用例 ✅

#### 3.1 用户资料访问
```
源IP: 192.168.1.10
目标IP: 203.0.113.1
流量类型: HTTPS
请求内容: /api/user/profile
预期结果: 正常流量
```

#### 3.2 静态资源加载
```
源IP: 10.0.0.1
目标IP: 192.168.1.100
流量类型: HTTP
请求内容: /static/css/style.css
预期结果: 正常流量
```

#### 3.3 图片资源访问
```
源IP: 172.16.0.50
目标IP: 172.16.0.1
流量类型: HTTP
请求内容: /images/logo.png
预期结果: 正常流量
```

#### 3.4 API数据查询
```
源IP: 192.168.2.10
目标IP: 192.168.2.1
流量类型: HTTPS
请求内容: /api/data/list
预期结果: 正常流量
```

#### 3.5 首页访问
```
源IP: 10.10.10.50
目标IP: 10.10.10.1
流量类型: HTTP
请求内容: /home/index.html
预期结果: 正常流量
```

#### 3.6 用户登录
```
源IP: 203.0.113.200
目标IP: 192.168.1.1
流量类型: HTTPS
请求内容: /api/auth/login
预期结果: 正常流量
```

#### 3.7 网站图标
```
源IP: 192.168.0.50
目标IP: 192.168.0.1
流量类型: HTTP
请求内容: /favicon.ico
预期结果: 正常流量
```

---

## 🔧 白流量规则测试用例

### 4. IP白名单规则测试

#### 4.1 内网IP段规则
**规则配置**:
- 规则名称: 内网IP白名单
- 规则类型: IP
- 规则值: 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12
- 状态: 启用

**测试用例**:
```
源IP: 192.168.1.100
目标IP: 192.168.1.1
流量类型: HTTP
请求内容: /admin/login.php
预期结果: 白流量 (匹配规则: 内网IP白名单)
```

#### 4.2 特定IP规则
**规则配置**:
- 规则名称: 服务器IP白名单
- 规则类型: IP
- 规则值: 203.0.113.1,203.0.113.2
- 状态: 启用

**测试用例**:
```
源IP: 203.0.113.1
目标IP: 192.168.1.1
流量类型: HTTP
请求内容: SELECT * FROM users
预期结果: 白流量 (匹配规则: 服务器IP白名单)
```

### 5. 域名白名单规则测试

#### 5.1 通配符域名规则
**规则配置**:
- 规则名称: 常用域名白名单
- 规则类型: 域名
- 规则值: *.google.com,*.baidu.com,*.github.com
- 状态: 启用

**测试用例**:
```
源IP: 192.168.1.50
目标IP: 8.8.8.8
流量类型: HTTP
请求内容: api.github.com/user/repos
预期结果: 白流量 (匹配规则: 常用域名白名单)
```

### 6. 端口白名单规则测试

#### 6.1 标准Web端口规则
**规则配置**:
- 规则名称: HTTP/HTTPS端口
- 规则类型: 端口
- 规则值: 80,443
- 状态: 启用

**测试用例**:
```
源IP: 192.168.1.100
目标IP: 203.0.113.50
流量类型: HTTP
请求内容: GET / HTTP/1.1 Host: example.com:80
预期结果: 白流量 (匹配规则: HTTP/HTTPS端口)
```

#### 6.2 端口范围规则
**规则配置**:
- 规则名称: 开发端口范围
- 规则类型: 端口
- 规则值: 3000-9000
- 状态: 启用

**测试用例**:
```
源IP: 127.0.0.1
目标IP: 127.0.0.1
流量类型: HTTP
请求内容: GET /api/test HTTP/1.1 Host: localhost:8080
预期结果: 白流量 (匹配规则: 开发端口范围)
```

### 7. 协议白名单规则测试

#### 7.1 安全协议规则
**规则配置**:
- 规则名称: 安全协议白名单
- 规则类型: 协议
- 规则值: HTTPS,SSH,SFTP
- 状态: 启用

**测试用例**:
```
源IP: 192.168.1.100
目标IP: 192.168.1.1
流量类型: HTTPS
请求内容: /admin/login.php
预期结果: 白流量 (匹配规则: 安全协议白名单)
```

---

## 🧪 规则状态测试用例

### 8. 规则启用/禁用测试

#### 8.1 规则禁用测试
**测试步骤**:
1. 禁用所有白流量规则
2. 测试内网IP流量

**测试用例**:
```
源IP: 192.168.0.0
目标IP: 192.168.0.0
流量类型: HTTP
请求内容: /api/test
预期结果: 正常流量 (不应该显示白流量)
```

#### 8.2 规则启用测试
**测试步骤**:
1. 启用内网IP白名单规则
2. 重新测试相同流量

**测试用例**:
```
源IP: 192.168.0.0
目标IP: 192.168.0.0
流量类型: HTTP
请求内容: /api/test
预期结果: 白流量 (匹配规则: 内网IP白名单)
```

---
